<!DOCTYPE html>
<html>
<head>
    <title>CommonUtils Demo</title>
    <script src="commonUtils.js"></script>
    <style>
        body { font-family: sans-serif; }
        .function-demo { border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; }
        .function-demo h3 { margin-top: 0; }
        input, button { margin-right: 5px; }
    </style>
</head>
<body>
    <h1>CommonUtils.js Demo</h1>

    <div id="demos"></div>

    <script>
        const utils = new CommonUtils();
        const demosContainer = document.getElementById('demos');

        function createDemo(title, fn, inputLabels) {
            const demoDiv = document.createElement('div');
            demoDiv.className = 'function-demo';

            const titleEl = document.createElement('h3');
            titleEl.textContent = title;
            demoDiv.appendChild(titleEl);

            const inputs = inputLabels.map(label => {
                const input = document.createElement('input');
                input.placeholder = label;
                demoDiv.appendChild(input);
                return input;
            });

            const button = document.createElement('button');
            button.textContent = 'Run';
            demoDiv.appendChild(button);

            const resultEl = document.createElement('p');
            resultEl.textContent = 'Result: ';
            demoDiv.appendChild(resultEl);

            button.addEventListener('click', () => {
                const inputValues = inputs.map(input => input.value);
                try {
                    if (typeof fn !== 'function') {
                        throw new Error(`The utility for '${title}' is not a function.`);
                    }
                    const args = inputValues.map((val, i) => {
                        // Attempt to convert to number if it looks like one
                        if (!isNaN(val) && val.trim() !== '') return Number(val);
                        // Attempt to convert to array if it looks like one
                        if (val.startsWith('[') && val.endsWith(']')) {
                            try {
                                return JSON.parse(val);
                            } catch (e) {
                                return val; // Keep as string if parsing fails
                            }
                        }
                        // Attempt to convert to date if it looks like a date string
                        const date = new Date(val);
                        if (!isNaN(date.getTime())) return date;
                        return val;
                    });
                    console.log(`Calling ${title} with arguments:`, args);
                    const result = fn(...args);
                    resultEl.textContent = 'Result: ' + JSON.stringify(result, null, 2);
                } catch (e) {
                    resultEl.textContent = 'Error: ' + e.message;
                    console.error(`Error in ${title} demo:`, e);
                }
            });

            demosContainer.appendChild(demoDiv);
        }

        // --- String Utilities ---
        createDemo('reverseString', utils.reverseString.bind(utils), ['string']);
        createDemo('countString', utils.countString.bind(utils), ['string']);
        createDemo('capitalizeString', utils.capitalizeString.bind(utils), ['string']);
        createDemo('truncateString', utils.truncateString.bind(utils), ['string', 'length']);
        createDemo('slugify', utils.slugify.bind(utils), ['string']);

        // --- Array Utilities ---
        createDemo('shuffleArray', utils.shuffleArray.bind(utils), ['array (e.g., [1,2,3])']);
        createDemo('uniqueArray', utils.uniqueArray.bind(utils), ['array (e.g., [1,1,2])']);
        createDemo('chunkArray', utils.chunkArray.bind(utils), ['array (e.g., [1,2,3,4])', 'size']);

        // --- Date/Time Utilities ---
        createDemo('formatDate', utils.formatDate.bind(utils), ['date (e.g., 2023-10-27)', 'format (e.g., YYYY-MM-DD)']);
        createDemo('timeAgo', utils.timeAgo.bind(utils), ['date (e.g., 2023-10-26)']);

        // --- Miscellaneous Utilities ---
        createDemo('generateRandomId', utils.generateRandomId.bind(utils), ['length']);

    </script>
</body>
</html>
